# 現状

チャンネルごとに設定できる。
チャンネルではラベルの名前を一つ指定できる。
対象のリポジトリのリストと、レビュワのリストを設定できる。

# 次のステップ（複数ラベル対応）

チャンネルごとに設定できる。
チャンネルではラベルを幾つでも設定できる。ラベルごとに設定は区別される。
設定ごとに対象のリポジトリのリストと、レビュワのリストを設定できる。

# 段階的リリース計画

## フェーズ1: モデル拡張の基盤整備（2-3日）

- **目標**: 既存の機能を壊さずに、将来の複数ラベル対応への基盤を整備する
- **変更内容**:
  - `SlackChannelID` と `LabelName` の複合ユニーク制約を設定
  - サービス層を微調整して後方互換性を維持
- **対応ユーザーシナリオ**:
  - 既存ユーザーには変更が見えない（後方互換性の維持）
  - 内部的に複数ラベル設定の基盤が整うが、ユーザーインターフェースには反映されない

## フェーズ2: 基本的なラベル管理機能の追加（3-4日）

- **目標**: LabelNameにラベル名を使用し、基本的なラベル管理機能を実装する
- **変更内容**:
  - 新しいコマンドインターフェースの追加:
    - `/review-config label add [ラベル名]` - 新しいラベル設定を追加
    - `/review-config label list` - 現在のチャンネルの全ラベル設定を表示
    - `/review-config label remove [ラベル名]` - ラベル設定を削除（非アクティブ化）
  - サービス層の機能追加（複数設定の取得と表示）
- **対応ユーザーシナリオ**:
  - チーム管理者が同じチャンネル内に複数のラベル設定を明示的に作成できる
  - 「フロントエンド関連のPRには frontend ラベル、バックエンド関連のPRには backend ラベルを設定したい」といった要望に対応
  - 現在のチャンネルに設定されている全ラベルを一覧表示して確認できる

## フェーズ3: ラベル固有の設定機能の追加（4-5日）

- **目標**: 各ラベル設定に独自のリポジトリリストとレビュワーリストを設定できるようにする
- **変更内容**:
  - ラベル指定コマンドの追加:
    - `/review-config for [ラベル名] repo add [リポジトリ名]` - 特定ラベルにリポジトリを追加
    - `/review-config for [ラベル名] reviewer add [ユーザー]` - 特定ラベルにレビュワーを追加
    - `/review-config for [ラベル名] mention set [ユーザー]` - 特定ラベルのメンション先を設定
  - サービス層の拡張（ラベル指定の設定取得と更新）
  - UIの改善と移行支援機能の提供
- **対応ユーザーシナリオ**:
  - ラベルごとに異なるレビュワーグループを設定できる（「UIラベルにはデザイナーとフロントエンドエンジニア、APIラベルにはバックエンドエンジニア」など）
  - ラベルごとに監視対象リポジトリを個別に設定できる（「securityラベルはすべてのリポジトリを監視、frontendラベルはフロントエンドリポジトリのみ監視」など）
  - 特定ラベルの通知先を専門チームに設定できる（「securityラベルはセキュリティチームに通知」など）

## フェーズ4: GitHub Webhook処理の完全対応と最適化（3-4日）

- **目標**: 複数ラベル設定に対するWebhook処理を完全に対応させ、パフォーマンスを最適化する
- **変更内容**:
  - Webhook処理の拡張（PRラベル付与時に複数の設定から適切なものを選択）
  - 複数ラベルが一致した場合の優先順位付け
  - パフォーマンス最適化（クエリの効率化）
  - より詳細な通知メッセージ（どのラベル設定で通知されているかの表示）
  - モニタリングとロギングの強化
- **対応ユーザーシナリオ**:
  - 1つのPRに複数のラベルが付けられた場合に適切な優先順位で処理される（「critical」ラベルは「bug」ラベルより優先されるなど）
  - PRに付けられたラベルに基づいて複数のチャンネルに適切な通知が送信される
  - 通知メッセージに「どのラベルによる通知か」が明示され、コンテキストが理解しやすくなる
  - 大量のラベル設定や多数のリポジトリがあっても、パフォーマンスが劣化しない
